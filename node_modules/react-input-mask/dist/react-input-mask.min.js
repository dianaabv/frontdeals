!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):e.ReactInputMask=t(e.React)}(this,function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function r(e,t,n){if(t===undefined&&(t=m),null==n&&(n=h),!e||"string"!=typeof e)return{maskChar:t,charsRules:n,mask:null,prefix:null,lastEditablePos:null,permanents:[]};var r="",a="",o=[],s=!1,i=null;return e.split("").forEach(function(e){s||"\\"!==e?(s||!n[e]?(o.push(r.length),r.length===o.length-1&&(a+=e)):i=r.length+1,r+=e,s=!1):s=!0}),{maskChar:t,charsRules:n,prefix:a,mask:r,lastEditablePos:i,permanents:o}}function a(e,t){return-1!==e.permanents.indexOf(t)}function o(e,t,n){var r=e.mask,o=e.charsRules;if(!n)return!1;if(a(e,t))return r[t]===n;var s=o[r[t]];return new RegExp(s).test(n)}function s(e,t){return t.split("").every(function(t,n){return a(e,n)||!o(e,n,t)})}function i(e,t){var n=e.maskChar,r=e.prefix;if(!n){for(;t.length>r.length&&a(e,t.length-1);)t=t.slice(0,t.length-1);return t.length}for(var s=r.length,i=t.length;i>=r.length;i--){var u=t[i];if(!a(e,i)&&o(e,i,u)){s=i+1;break}}return s}function u(e,t){return i(e,t)===e.mask.length}function l(e,t){var n=e.maskChar,r=e.mask,o=e.prefix;if(!n)return t=f(e,"",t,0),(t=t.slice(0,i(e,t))).length<o.length&&(t=o),t;if(t){return f(e,l(e,""),t,0)}for(var s=0;s<r.length;s++)a(e,s)?t+=r[s]:t+=n;return t}function c(e,t,n,r){var o=n+r,s=e.maskChar,i=e.mask,u=e.prefix,c=t.split("");return s?c.map(function(t,r){return r<n||r>=o?t:a(e,r)?i[r]:s}).join(""):(n=Math.max(u.length,n),c.splice(n,o-n),t=c.join(""),l(e,t))}function f(e,t,n,r){var s=e.mask,i=e.maskChar,c=e.prefix,f=n.split(""),p=u(e,t),h=function(t,n){return!a(e,t)||n===s[t]},m=function(t,n){return!i||!a(e,n)||t!==i};return!i&&r>t.length&&(t+=s.slice(t.length,r)),f.every(function(n){for(;!h(r,n);){if(r>=t.length&&(t+=s[r]),!m(n,r))return!0;if(++r>=s.length)return!1}return!o(e,r,n)&&n!==i||(r<t.length?i||p||r<c.length?t=t.slice(0,r)+n+t.slice(r+1):(t=t.slice(0,r)+n+t.slice(r),t=l(e,t)):i||(t+=n),++r<s.length)}),t}function p(e){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(){return setTimeout(e,0)})(e)}var h={9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},m="_",g=function(t){function a(e){var n;n=t.call(this,e)||this,b.call(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n));var a=e.mask,o=e.maskChar,s=e.formatChars,i=e.defaultValue,u=e.value,c=e.alwaysShowMask;return n.hasValue=null!=u,n.maskOptions=r(a,o,s),null==i&&(i=""),null==u&&(u=i),u=n.getStringValue(u),n.maskOptions.mask&&(c||u)&&(u=l(n.maskOptions,u)),n.value=u,n}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}(a,t);var o=a.prototype;return o.componentDidMount=function(){this.isAndroidBrowser=function(){var e=new RegExp("windows","i"),t=new RegExp("firefox","i"),n=new RegExp("android","i"),r=navigator.userAgent;return!e.test(r)&&!t.test(r)&&n.test(r)}(),this.isWindowsPhoneBrowser=function(){var e=new RegExp("windows","i"),t=new RegExp("phone","i"),n=navigator.userAgent;return e.test(n)&&t.test(n)}(),this.isAndroidFirefox=function(){var e=new RegExp("windows","i"),t=new RegExp("firefox","i"),n=new RegExp("android","i"),r=navigator.userAgent;return!e.test(r)&&t.test(r)&&n.test(r)}(),this.maskOptions.mask&&this.getInputValue()!==this.value&&this.setInputValue(this.value)},o.componentWillReceiveProps=function(e){var t=this.maskOptions;if(this.hasValue=null!=e.value,this.maskOptions=r(e.mask,e.maskChar,e.formatChars),!this.maskOptions.mask)return this.backspaceOrDeleteRemoval=null,void(this.lastCursorPos=null);var n=this.maskOptions.mask&&this.maskOptions.mask!==t.mask,a=e.alwaysShowMask||this.isFocused(),o=this.hasValue?this.getStringValue(e.value):this.value;if(t.mask||this.hasValue||(o=this.getInputDOMNode().value),(n||this.maskOptions.mask&&(o||a))&&(o=l(this.maskOptions,o),n)){var c=this.lastCursorPos,f=i(this.maskOptions,o);(null===c||f<c)&&(c=u(this.maskOptions,o)?f:this.getRightEditablePos(f),this.setCursorPos(c))}!this.maskOptions.mask||!s(this.maskOptions,o)||a||this.hasValue&&e.value||(o=""),this.value=o},o.componentDidUpdate=function(){this.maskOptions.mask&&this.getInputValue()!==this.value&&this.setInputValue(this.value)},o.render=function(){var t=this,r=this.props,a=(r.mask,r.alwaysShowMask,r.maskChar,r.formatChars,function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(r,["mask","alwaysShowMask","maskChar","formatChars"]));if(this.maskOptions.mask){if(!a.disabled&&!a.readOnly){["onChange","onKeyDown","onPaste","onMouseDown"].forEach(function(e){a[e]=t[e]})}null!=a.value&&(a.value=this.value)}return e.createElement("input",n({ref:function(e){return t.input=e}},a,{onFocus:this.onFocus,onBlur:this.onBlur}))},a}((e=e&&e.hasOwnProperty("default")?e["default"]:e).Component),b=function(){var n=this;Object.defineProperty(this,"lastCursorPos",{configurable:!0,enumerable:!0,writable:!0,value:null}),Object.defineProperty(this,"focused",{configurable:!0,enumerable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isDOMElement",{configurable:!0,enumerable:!0,writable:!0,value:function(e){return"object"===("undefined"==typeof HTMLElement?"undefined":t(HTMLElement))?function(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?t[Symbol.hasInstance](e):e instanceof t}(e,HTMLElement):1===e.nodeType&&"string"==typeof e.nodeName}}),Object.defineProperty(this,"getInputDOMNode",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=n.input;return t?n.isDOMElement(t)?t:e.findDOMNode(t):null}}),Object.defineProperty(this,"getInputValue",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=n.getInputDOMNode();return e?e.value:null}}),Object.defineProperty(this,"setInputValue",{configurable:!0,enumerable:!0,writable:!0,value:function(e){var t=n.getInputDOMNode();t&&(n.value=e,t.value=e)}}),Object.defineProperty(this,"getLeftEditablePos",{configurable:!0,enumerable:!0,writable:!0,value:function(e){for(var t=e;t>=0;--t)if(!a(n.maskOptions,t))return t;return null}}),Object.defineProperty(this,"getRightEditablePos",{configurable:!0,enumerable:!0,writable:!0,value:function(e){for(var t=n.maskOptions.mask,r=e;r<t.length;++r)if(!a(n.maskOptions,r))return r;return null}}),Object.defineProperty(this,"setCursorToEnd",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=i(n.maskOptions,n.value),t=n.getRightEditablePos(e);null!==t&&n.setCursorPos(t)}}),Object.defineProperty(this,"setSelection",{configurable:!0,enumerable:!0,writable:!0,value:function(e,t){void 0===t&&(t=0);var r=n.getInputDOMNode();if(r){var a=e+t;if("selectionStart"in r&&"selectionEnd"in r)r.selectionStart=e,r.selectionEnd=a;else{var o=r.createTextRange();o.collapse(!0),o.moveStart("character",e),o.moveEnd("character",a-e),o.select()}}}}),Object.defineProperty(this,"getSelection",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=n.getInputDOMNode(),t=0,r=0;if("selectionStart"in e&&"selectionEnd"in e)t=e.selectionStart,r=e.selectionEnd;else{var a=document.selection.createRange();a.parentElement()===e&&(t=-a.moveStart("character",-e.value.length),r=-a.moveEnd("character",-e.value.length))}return{start:t,end:r,length:r-t}}}),Object.defineProperty(this,"getCursorPos",{configurable:!0,enumerable:!0,writable:!0,value:function(){return n.getSelection().start}}),Object.defineProperty(this,"setCursorPos",{configurable:!0,enumerable:!0,writable:!0,value:function(e){n.setSelection(e,0),p(function(){n.setSelection(e,0)}),n.lastCursorPos=e}}),Object.defineProperty(this,"isFocused",{configurable:!0,enumerable:!0,writable:!0,value:function(){return n.focused}}),Object.defineProperty(this,"getStringValue",{configurable:!0,enumerable:!0,writable:!0,value:function(e){return e||0===e?e+"":""}}),Object.defineProperty(this,"onKeyDown",{configurable:!0,enumerable:!0,writable:!0,value:function(e){n.backspaceOrDeleteRemoval=null,"function"==typeof n.props.onKeyDown&&n.props.onKeyDown(e);var t=e.key,r=e.ctrlKey,a=e.metaKey,o=e.defaultPrevented;if(!(r||a||o||"Backspace"!==t&&"Delete"!==t)){var s=n.getSelection();if(!("Backspace"===t&&s.end>0||"Delete"===t&&n.value.length>s.start))return;n.backspaceOrDeleteRemoval={key:t,selection:n.getSelection()}}}}),Object.defineProperty(this,"onChange",{configurable:!0,enumerable:!0,writable:!0,value:function(e){var t=n.beforePasteState,r=n.maskOptions,a=r.mask,o=r.maskChar,s=r.lastEditablePos,u=r.prefix,h=n.getInputValue();if(t)return n.beforePasteState=null,void n.pasteText(t.value,h,t.selection,e);var m=n.value,g=n.getInputDOMNode();try{"function"==typeof g.matches&&g.matches(":-webkit-autofill")&&(m="")}catch(j){}var b,d,v=n.getSelection(),k=v.end,O=a.length,y=h.length,w=m.length;if(n.backspaceOrDeleteRemoval){var P="Delete"===n.backspaceOrDeleteRemoval.key;if(h=n.value,v=n.backspaceOrDeleteRemoval.selection,k=v.start,n.backspaceOrDeleteRemoval=null,v.length)h=c(n.maskOptions,h,v.start,v.length);else if(v.start<u.length||!P&&v.start===u.length)k=u.length;else{var E=P?n.getRightEditablePos(k):n.getLeftEditablePos(k-1);null!==E&&(h=c(n.maskOptions,h,E,1),k=E)}}else if(y>w){var C=y-w,D=v.end-C;d=h.substr(D,C),k=D<s&&(1!==C||d!==a[D])?n.getRightEditablePos(D):D,h=h.substr(0,D)+h.substr(D+C),b=c(n.maskOptions,h,D,O-D),b=f(n.maskOptions,b,d,k),h=f(n.maskOptions,m,d,k),1!==C||k>=u.length&&k<s?(k=Math.max(i(n.maskOptions,b),k))<s&&(k=n.getRightEditablePos(k)):k<s&&k++}else if(y<w){var S=O-y,R=(d=h.substr(0,v.end))===m.substr(0,v.end);b=c(n.maskOptions,m,v.end,S),o&&(h=f(n.maskOptions,b,d,0)),b=c(n.maskOptions,b,v.end,O-v.end),b=f(n.maskOptions,b,d,0),R?k<u.length&&(k=u.length):(k=Math.max(i(n.maskOptions,b),k))<s&&(k=n.getRightEditablePos(k))}h=l(n.maskOptions,h),n.setInputValue(h),"function"==typeof n.props.onChange&&n.props.onChange(e),n.isWindowsPhoneBrowser?p(function(){n.setSelection(k,0)}):n.setCursorPos(k)}}),Object.defineProperty(this,"onFocus",{configurable:!0,enumerable:!0,writable:!0,value:function(e){if(n.focused=!0,n.maskOptions.mask)if(n.value)i(n.maskOptions,n.value)<n.maskOptions.mask.length&&n.setCursorToEnd();else{var t=n.maskOptions.prefix,r=l(n.maskOptions,t),a=l(n.maskOptions,r),o=a!==e.target.value;o&&(e.target.value=a),n.value=a,o&&"function"==typeof n.props.onChange&&n.props.onChange(e),n.setCursorToEnd()}"function"==typeof n.props.onFocus&&n.props.onFocus(e)}}),Object.defineProperty(this,"onBlur",{configurable:!0,enumerable:!0,writable:!0,value:function(e){if(n.focused=!1,n.maskOptions.mask&&!n.props.alwaysShowMask&&s(n.maskOptions,n.value)){var t=""!==n.getInputValue();t&&n.setInputValue(""),t&&"function"==typeof n.props.onChange&&n.props.onChange(e)}"function"==typeof n.props.onBlur&&n.props.onBlur(e)}}),Object.defineProperty(this,"onMouseDown",{configurable:!0,enumerable:!0,writable:!0,value:function(e){if(!n.focused&&document.addEventListener){n.mouseDownX=e.clientX,n.mouseDownY=e.clientY,n.mouseDownTime=(new Date).getTime();document.addEventListener("mouseup",function t(e){if(document.removeEventListener("mouseup",t),n.focused){var r=Math.abs(e.clientX-n.mouseDownX),a=Math.abs(e.clientY-n.mouseDownY),o=Math.max(r,a),s=(new Date).getTime()-n.mouseDownTime;(o<=10&&s<=200||o<=5&&s<=300)&&n.setCursorToEnd()}})}"function"==typeof n.props.onMouseDown&&n.props.onMouseDown(e)}}),Object.defineProperty(this,"onPaste",{configurable:!0,enumerable:!0,writable:!0,value:function(e){"function"==typeof n.props.onPaste&&n.props.onPaste(e),e.defaultPrevented||(n.beforePasteState={value:n.getInputValue(),selection:n.getSelection()},n.setInputValue(""))}}),Object.defineProperty(this,"pasteText",{configurable:!0,enumerable:!0,writable:!0,value:function(e,t,r,s){var i=r.start;r.length&&(e=c(n.maskOptions,e,i,r.length));var u=function(e,t,n,r){var s=e.mask,i=e.maskChar,u=n.split(""),l=r,c=function(t,n){return!a(e,t)||n===s[t]};return u.every(function(t){for(;!c(r,t);)if(++r>=s.length)return!1;return(o(e,r,t)||t===i)&&r++,r<s.length}),r-l}(n.maskOptions,0,t,i);e=f(n.maskOptions,e,t,i),i+=u,i=n.getRightEditablePos(i)||i,n.setInputValue(e),s&&"function"==typeof n.props.onChange&&n.props.onChange(s),n.setCursorPos(i)}})};return g});
